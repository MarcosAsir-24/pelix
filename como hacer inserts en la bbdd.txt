CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL,
    apellidos VARCHAR(100) NOT NULL,
    fecha_nacimiento DATE NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    telefono VARCHAR(20),
    stripe_customer_id VARCHAR(255),  
    tarjeta_ultimos4 VARCHAR(4),     
    tarjeta_marca VARCHAR(20),       
    tarjeta_expiracion VARCHAR(5),   
    direccion TEXT NOT NULL,
    password_hash VARCHAR(255) NOT NULL,  
    fecha_registro DATETIME DEFAULT CURRENT_TIMESTAMP,
    suscripcion_inicio DATE,         
    suscripcion_fin DATE             
);

CREATE TABLE categorias (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL UNIQUE,
    descripcion TEXT,
    icono VARCHAR(100)  
);

CREATE TABLE peliculas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(100) NOT NULL,
    categoria_id INT NOT NULL,
    imagen VARCHAR(255) NOT NULL,  
    duracion INT NOT NULL,         
    sinopsis TEXT NOT NULL,
    destacada BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (categoria_id) REFERENCES categorias(id)
);

CREATE TABLE pagos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT NOT NULL,
    stripe_payment_id VARCHAR(255) NOT NULL,
    monto DECIMAL(6,2) NOT NULL,
    estado ENUM('exitoso', 'fallido', 'pendiente') NOT NULL,
    fecha_pago DATETIME DEFAULT CURRENT_TIMESTAMP,
    suscripcion_inicio DATE NOT NULL,
    suscripcion_fin DATE NOT NULL,
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);

INSERT INTO categorias (nombre, icono) VALUES 
('Acción', 'img/categorias/accion.png'),
('Comedia', 'img/categorias/comedia.png'),
('Terror', 'img/categorias/terror.png'),
('Próximamente', 'img/categorias/proximamente.png'),
('Ciencia Ficción', 'img/categorias/cienciaficcion.png'),
('Animación', 'img/categorias/animacion.png'),


INSERT INTO peliculas (titulo, categoria_id, imagen, duracion, sinopsis, destacada) VALUES
('John Wick', 4, 'img/peliculas/johnwick.jpg', 101, 'En Nueva York, John Wick, un asesino a sueldo retirado, vuelve otra vez a la acción para vengarse de los gánsteres que le quitaron todo.', TRUE),
('Terminator', 4, 'img/peliculas/terminator.jpg', 107, 'En el año 2029 las máquinas dominan el mundo. Los rebeldes que luchan contra ellas tienen como líder a John Connor, un hombre que nació en los años ochenta.', TRUE),
('El último boy scout', 4, 'img/peliculas/ultimoboyscout.jpg', 105, 'Un detective privado en horas bajas, cuya carrera terminó al enfrentarse con un político corrupto y una gran estrella del fútbol que cae en desgracia al verse involucrado en un supuesto escándalo, se unirán para resolver sus problemas.', TRUE),
('Torrente', 7, 'img/peliculas/torrente.jpg', 97, 'Torrente es un policía español, machista, racista y alcohólico. Este magnífico representante de las fuerzas del orden vive, con su padre hemipléjico, en Madrid. Gracias a su olfato, descubre en su propio barrio una importante red de narcotraficantes.', TRUE),
('La vida de Brian', 7, 'img/peliculas/vidadebrian.jpg', 94, 'Durante la época bíblica, un hombre parece ser el Mesías y se ve puesto como líder de un movimiento religioso. Su vida estará marcada por su castrante madre, sus nuevos amigos del Frente Popular de Judea y su novia feminista.', TRUE), 
('Resacón en las Vegas', 7, 'img/peliculas/resacon.jpg', 100, 'Cuatro amigos celebran la despedida de soltero de uno de ellos en Las Vegas. Pero, cuando a la mañana siguiente no pueden encontrar al novio y no recuerdan nada, deberán intentar volver sobre sus pasos, antes de que llegue la hora de la boda.', TRUE),
('IT', 8, 'img/peliculas/it.jpg', 135, 'Varios niños de una pequeña ciudad del estado de Maine se alían para combatir a una entidad diabólica que adopta la forma de un payaso y desde hace mucho tiempo emerge cada 27 años para saciarse de sangre infantil.', TRUE),
('Hereditary', 8, 'img/peliculas/hereditary.jpg', 127, 'Después de la muerte de la matriarca de los Graham, su hija, Annie, se muda a la casa con su familia. Annie espera olvidar los problemas que tuvo en su infancia allí, pero todo se tuerce cuando su hija empieza a ver figuras fantasmales.', TRUE),
('El silencio de los corderos', 8, 'img/peliculas/silencio.jpg', 118, 'Tras una serie de crímenes donde a las víctimas les faltaba parte de la piel, una agente del FBI inicia su carrera particular para dar con el asesino. Para resolver el caso la agente encargada deberá envtrevistarse con el doctor Hannibal Lecter.', TRUE),
('Interstellar', 10, 'img/peliculas/interstellar.jpg', 169, 'Un grupo de científicos y exploradores, encabezados por Cooper, se embarcan en un viaje espacial para encontrar un lugar con las condiciones necesarias para reemplazar a la Tierra y comenzar una nueva vida allí.', TRUE),
('Star Wars I', 10, 'img/peliculas/starwars1.jpg', 136, 'La República Galáctica está sumida en el caos. Los impuestos de las rutas comerciales a los sistemas estelares exteriores están en disputa. Esperando resolver el asunto con un bloqueo de poderosas naves de guerra, la codiciosa Federación del Comercio ha detenido todos los envíos al pequeño planeta de Naboo.', TRUE),
('Star Wars II', 10, 'img/peliculas/starwars2.jpg', 142, 'En el Senado Galáctico reina la inquietud. Varios miles de sistemas solares han declarado su intención de abandonar la República. Este movimiento separatista, liderado por el misterioso conde Dooku, ha provocado que al limitado número de caballeros Jedi les resulte difícil mantener la paz y el orden en la galaxia.', TRUE),
('Star Wars III', 10, 'img/peliculas/starwars3.jpg', 140, '¡Guerra! La República se desmorona bajo los ataques del despiadado Lord Sith, el conde Dooku. Hay héroes en ambos bandos, pero el mal está por doquier.', TRUE),
('Star Wars IV', 10, 'img/peliculas/starwars4.jpg', 121, 'La nave en la que viaja la princesa Leia es capturada por las tropas imperiales al mando del temible Darth Vader. Antes de ser atrapada, Leia consigue introducir un mensaje en su robot R2-D2, quien acompañado de su inseparable C-3PO logran escapar.', TRUE),
('Fast and Furious', 4, 'img/peliculas/fastandfurious.jpg', 106, 'Cada noche, Los Ángeles es testigo de alguna carrera de coches. Últimamente ha aparecido un nuevo corredor, todos saben que es duro y que es rápido, pero lo que no saben es que es un detective con la determinación de salir victorioso.', TRUE),
('Fast and Furious II', 4, 'img/peliculas/fastandfurious2.jpg', 107, 'Brian O'Conner ayuda a la policía de Miami y se infiltra en el mundo de las carreras ilegales, esperando así redimirse ante sus superiores.', TRUE),
('Fast and Furious III', 4, 'img/peliculas/fastandfurious3.jpg', 104, 'Shaun Boswell es un chico rebelde cuya única conexión con el mundo es a través de las carreras ilegales. Cuando la policía le amenaza con encarcelarle, se va a pasar una temporada con su tío, un militar destinado en Japón.', TRUE),
('Fast and Furious IV', 4, 'img/peliculas/fastandfurious4.jpg', 107, 'El ex convicto Dominic Toretto se une a su viejo adversario, Brian O'Conner, que ahora trabaja para el FBI en Los Ángeles, con el fin de infiltrarse en una organización criminal que se dedica a introducir heroína en la ciudad.', TRUE),
('Fast and Furious V', 4, 'img/peliculas/fastandfurious5.jpg', 130, 'Los viejos amigos Dominic y Mia Toretto y Brian O'Conner se encuentran ahora en Río de Janeiro, donde pretenden dar un último golpe con el fin de obtener su libertad. Para ello reúnen a un grupo de élite de pilotos experimentados.', TRUE),
('Resacón II', 7, 'img/peliculas/resacon2.jpg', 102, 'Alan, Stu y Phil vuelven a despertarse en otra habitación de otro hotel y, para no perder la costumbre, en esta ocasión tampoco recuerdan nada. Esta vez sólo saben que están en Tailandia, a donde han viajado, junto a Doug, para asistir a la boda de Stu con Lauren.', TRUE),
('los caballeros de la mesa redonda, 7, 'img/peliculas/caballerosmesacuadrada.jpg', 91, 'La historia de las peripecias del rey Arturo y de sus caballeros de la mesa redonda durante la búsqueda del Santo Grial.', TRUE),
('Resacón  III', 7, 'img/peliculas/resacon3.jpg', 100, 'Tras la inesperada muerte de su padre, Alan es llevado por sus amigos Phil, Stu y Doug a un centro especializado para que mejore. Esta vez no hay boda ni fiesta de despedida, ¿qué puede ir mal?', TRUE),
('Resacón en las Vegas: ellas también', 7, 'img/peliculas/resacon4.jpg', 90, 'Claire se va a casar y su alocada amiga Zoe le organiza un viaje a Las Vegas para celebrar su despedida de soltera. Con ellas van Leslie, la hermana de Claire, y Janet, la encargada del volante.', TRUE),
('Supercool', 7, 'img/peliculas/supercool.jpg', 119, 'Evan y Seth, dos adolescentes inadaptados, amigos desde la infancia, están a punto de graduarse en el instituto, pero antes de que sus vidas se separen para ir a la universidad, ambos van a intentar pasar una última e irrepetible noche de juerga.', TRUE),
('Kraven el cazador', 9, 'img/peliculas/kraven.jpg', 127, 'El inmigrante ruso Sergei Kravinoff emprende una misión para demostrar que es el mejor cazador del mundo.', TRUE),
('F1: La película', 9, 'img/peliculas/f1.jpg', 120, 'Se nos presenta el campeonato de carreras de Fórmula 1, creado en colaboración con la FIA, su organismo rector.', TRUE),
('Destino final 6: Lazos de Sangre', 9, 'img/peliculas/destinofinal.jpg', 109, 'Stefanie, una estudiante universitaria, se ve atormentada por pesadillas recurrentes sobre un accidente que le sucedió a su abuela hace décadas. Descubre que la muerte persigue a las familias de quienes sobrevivieron a accidentes, y su propia familia está en peligro. Para salvar a su familia, Stefanie debe encontrar la manera de detener la maldición que los persigue.', TRUE),
('Misión imposible: Sentencia final', 9, 'img/peliculas/misionimposibleprox.jpg', 170, 'Las nuevas aventuras del agente del FMI y líder de un equipo de operativos, Ethan Hunt.', TRUE),
('Thunderbolts', 9, 'img/peliculas/thunderbolts.jpg', 126, 'Película de Marvel en la que -como si de un Escuadrón suicida se tratase- un grupo de villanos son enviados a misiones por encargo del gobierno.', TRUE),
('Minecraft', 9, 'img/peliculas/minecraft.jpg', 101, 'Cuatro inadaptados son absorbidos de repente por un misterioso portal hacia el Supramundo: un extraño y cúbico país de las maravillas que vive gracias a la imaginación. Para volver a casa, se embarcan en una búsqueda mágica con un artesano.', TRUE),
('La trama fenicia', 9, 'img/peliculas/tramafenicia.jpg', 105, 'Cuenta la historia de Zsa-zsa Korda, un magnate europeo de la industria de armamento y aviación, que tras una serie de intentos de asesinato decide preparar a su hija Liesl, una monja, como su heredera.', TRUE),
('SAW I', 8, 'img/peliculas/saw1.jpg', 103, 'Adam y Lawrence se despiertan encadenados en un sucio baño con un cadáver entre ellos. Su secuestrador es un loco conocido como Jigsaw cuyo juego consiste en forzar a sus cautivos a herirse a si mismos o a otros con tal de permanecer vivos.', TRUE),
('SAW II', 8, 'img/peliculas/saw2.jpg', 95, 'Aparece una nueva víctima de Jigsaw y Eric Matthews decide investigar. Jigsaw es detenido, aunque esto forma parte de su plan, y del que Matthews deberá participar si desea salvar a otras 8 personas.', TRUE),
('SAW III', 8, 'img/peliculas/saw3.jpg', 108, 'Mientras la policía trata de atrapar a Jigsaw y a su ayudante Amanda, la doctora Lynn Denlon se convierte en la última pieza de su diabólico juego.', TRUE);